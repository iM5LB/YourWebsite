<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Loading...">
  <meta name="keywords" content="Loading...">
  <meta name="author" content="">
  <title>Loading...</title>
  <link rel="icon" type="image/jpeg" href="/logo.jpg">
  <link rel="apple-touch-icon" href="/logo.jpg">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://elfsightcdn.com/platform.js" async></script>
  <script>
    // Enhanced global error handler for widget and API errors
    window.addEventListener('error', function(e) {
      const message = e.message || '';
      const filename = e.filename || '';
      
      // Suppress Elfsight social feed errors
      if (
        message.includes('insertBefore') || 
        message.includes('twitter source') ||
        message.includes('socialFeed') ||
        filename.includes('socialFeed.js') ||
        filename.includes('platform.js') ||
        message.includes('An error occurred while creating twitter source')
      ) {
        console.warn('Widget error suppressed:', message);
        e.preventDefault();
        e.stopPropagation();
        return false;
      }

      // Suppress Google Maps API CSP test errors
      if (
        message.includes('ERR_BLOCKED_BY_CLIENT') ||
        filename.includes('maps.googleapis.com') ||
        filename.includes('gen_204') ||
        message.includes('csp_test')
      ) {
        console.warn('Maps API error suppressed:', message);
        e.preventDefault();
        e.stopPropagation();
        return false;
      }
    });

    // Enhanced promise rejection handler
    window.addEventListener('unhandledrejection', function(e) {
      const reason = e.reason || {};
      const message = reason.message || reason.toString();
      
      if (
        message.includes('twitter') ||
        message.includes('insertBefore') ||
        message.includes('elfsight') ||
        message.includes('socialFeed') ||
        message.includes('maps.googleapis.com') ||
        message.includes('ERR_BLOCKED_BY_CLIENT')
      ) {
        console.warn('Promise rejection suppressed:', message);
        e.preventDefault();
        return false;
      }
    });

    // Override console.error for specific widget errors
    const originalConsoleError = console.error;
    console.error = function(...args) {
      const message = args.join(' ');
      if (
        message.includes('twitter source') ||
        message.includes('socialFeed') ||
        message.includes('ERR_BLOCKED_BY_CLIENT') ||
        message.includes('maps.googleapis.com')
      ) {
        // Suppress these specific errors
        return;
      }
      originalConsoleError.apply(console, args);
    };

    // Monkey patch fetch to handle blocked requests gracefully
    const originalFetch = window.fetch;
    window.fetch = function(...args) {
      const url = args[0];
      if (typeof url === 'string' && (
        url.includes('maps.googleapis.com/maps/api/mapsjs/gen_204') ||
        url.includes('csp_test=true') ||
        url.includes('twitter.com/') ||
        url.includes('api.twitter.com/')
      )) {
        // Return a resolved promise for blocked requests
        return Promise.resolve(new Response('{}', { 
          status: 200,
          headers: { 'Content-Type': 'application/json' }
        }));
      }
      return originalFetch.apply(this, args);
    };

    // Monkey patch XMLHttpRequest for older API calls
    const originalXHROpen = XMLHttpRequest.prototype.open;
    XMLHttpRequest.prototype.open = function(method, url, ...args) {
      if (typeof url === 'string' && (
        url.includes('maps.googleapis.com/maps/api/mapsjs/gen_204') ||
        url.includes('csp_test=true') ||
        url.includes('twitter.com/') ||
        url.includes('api.twitter.com/')
      )) {
        // Mock the request
        this.send = function() {
          setTimeout(() => {
            this.readyState = 4;
            this.status = 200;
            this.responseText = '{}';
            if (this.onreadystatechange) this.onreadystatechange();
            if (this.onload) this.onload();
          }, 0);
        };
        return;
      }
      return originalXHROpen.apply(this, [method, url, ...args]);
    };
  </script>
</head>
<body>
  <div id="root"></div>
  <script type="module" src="/src/main.jsx"></script>
</body>
</html>
